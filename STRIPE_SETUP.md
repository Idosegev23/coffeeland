# ×”×•×¨××•×ª ×”×’×“×¨×ª Stripe

## ğŸ¦ ×™×¦×™×¨×ª ×—×©×‘×•×Ÿ Stripe

1. **×”×™×¨×©××• ×œ-Stripe:**
   - https://dashboard.stripe.com/register
   - ×‘×—×¨×• ××“×™× ×”: Israel
   - ××œ××• ××ª ×”×¤×¨×˜×™×

2. **×¢×‘×¨×• ×œ××¦×‘ Test:**
   - ×‘×¦×“ ×”×©×××œ×™ ×”×¢×œ×™×•×Ÿ ×ª×¨××• ××ª×’ "Test mode"
   - ×•×“××• ×©×”×•× ×“×œ×•×§ (×›×—×•×œ)

## ğŸ”‘ ×§×‘×œ×ª API Keys

### Publishable Key (×¦×™×‘×•×¨×™)
1. ×¢×‘×¨×• ×œ-**Developers > API keys**
2. ×”×¢×ª×™×§×• ××ª **Publishable key**
3. ×”×•×¡×™×¤×• ×œ-`.env.local`:
   ```env
   NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_51...
   ```

### Secret Key (×¡×•×“×™)
1. ×‘××•×ª×• ××§×•×, ×”×¢×ª×™×§×• ××ª **Secret key**
2. ×”×•×¡×™×¤×• ×œ-`.env.local`:
   ```env
   STRIPE_SECRET_KEY=sk_test_51...
   ```

## ğŸª ×”×’×“×¨×ª Webhooks

### ×™×¦×™×¨×ª Webhook Endpoint
1. ×¢×‘×¨×• ×œ-**Developers > Webhooks**
2. ×œ×—×¦×• **Add endpoint**
3. ×”×•×¡×™×¤×• URL: `https://your-domain.com/api/webhooks/stripe`
   - ×œ×¤×™×ª×•×—: `http://localhost:3000/api/webhooks/stripe`
4. ×‘×—×¨×• Events:
   - `checkout.session.completed`
   - `payment_intent.succeeded`
   - `payment_intent.payment_failed`

### ×§×‘×œ×ª Webhook Secret
1. ×œ×—×¦×• ×¢×œ ×”-webhook ×©×™×¦×¨×ª×
2. ×œ×—×¦×• **Reveal** ×œ×™×“ "Signing secret"
3. ×”×¢×ª×™×§×• ××ª ×”××¤×ª×—
4. ×”×•×¡×™×¤×• ×œ-`.env.local`:
   ```env
   STRIPE_WEBHOOK_SECRET=whsec_1234...
   ```

## ğŸ’³ ×›×¨×˜×™×¡×™ ×‘×“×™×§×”

×œ×‘×“×™×§×ª ×ª×©×œ×•××™× ×”×©×ª××©×• ×‘×›×¨×˜×™×¡×™× ×”×œ×œ×•:

### ×”×¦×œ×—×”
```
××¡×¤×¨ ×›×¨×˜×™×¡: 4242 4242 4242 4242
×ª××¨×™×š: ×›×œ ×ª××¨×™×š ×¢×ª×™×“×™ (12/25)
CVC: ×›×œ 3 ×¡×¤×¨×•×ª (123)
ZIP: ×›×œ ××™×§×•×“ (12345)
```

### ×›×¨×˜×™×¡ × ×“×—×”
```
××¡×¤×¨ ×›×¨×˜×™×¡: 4000 0000 0000 0002
×ª××¨×™×š: ×›×œ ×ª××¨×™×š ×¢×ª×™×“×™
CVC: ×›×œ 3 ×¡×¤×¨×•×ª
```

### ×“×•×¨×© ××™××•×ª 3D Secure
```
××¡×¤×¨ ×›×¨×˜×™×¡: 4000 0025 0000 3155
×ª××¨×™×š: ×›×œ ×ª××¨×™×š ×¢×ª×™×“×™
CVC: ×›×œ 3 ×¡×¤×¨×•×ª
```

## ğŸ§ª ×‘×“×™×§×ª ×”×ª×”×œ×™×š

1. **×”×¤×¢×™×œ×• ××ª ×”×©×¨×ª:**
   ```bash
   npm run dev
   ```

2. **×¢×‘×¨×• ×œ×“×£ ×”×‘×™×ª:** http://localhost:3000

3. **× ×¡×• ×œ×”×–××™×Ÿ ××©×”×•:**
   - ×œ×—×¦×• ×¢×œ ×‘×× ×¨ ×—×
   - ×”×•×¡×™×¤×• ××•×¦×¨ ×œ×¢×’×œ×”  
   - ×¢×‘×¨×• ×œ×ª×©×œ×•×

4. **×”×©×œ×™××• ×ª×©×œ×•× ×¢× ×›×¨×˜×™Ø³ ×‘×“×™×§×”**

5. **×‘×“×§×• ×‘-Stripe Dashboard:**
   - ×¢×‘×¨×• ×œ-**Payments**
   - ×ª×¨××• ××ª ×”×ª×©×œ×•× ×”×—×“×©

## ğŸ› ï¸ ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª × ×¤×•×¦×•×ª

### "No such customer"
- ×•×“××• ×©×”-Secret Key × ×›×•×Ÿ
- ×‘×“×§×• ×©××ª× ×‘××¦×‘ Test

### "Invalid webhook signature"  
- ×•×“××• ×©×”-Webhook Secret × ×›×•×Ÿ
- ×‘×“×§×• ×©×”-URL ×©×œ ×”-webhook ×ª×•××

### "Payment requires confirmation"
- ×–×” × ×•×¨××œ×™ ×¢× ×›×¨×˜×™×¡×™ 3D Secure
- ×”××©×™×›×• ×‘×ª×”×œ×™×š ×”××™××•×ª

## ğŸŒ ×”×’×“×¨×•×ª ×™×©×¨××œ

×‘Stripe Dashboard:
1. **Settings > Business settings**
2. **Country:** Israel
3. **Currency:** ILS (×©×§×œ)
4. **Tax settings:** ×œ×¤×™ ×”×¦×•×¨×š

×–×” ×™×‘×˜×™×— ×©×”×ª×©×œ×•××™× ×™×ª×‘×¦×¢×• ×‘×©×§×œ×™× ×•×¢× ×”××™×¡×™× ×”× ×›×•× ×™×.
